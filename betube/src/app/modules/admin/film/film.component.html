<h4 class="font-weight-bold mb-4">Quản lý Phim</h4>
<div class="mb-3 row">
  <div class="col-md-2">
    <button type="button" class="btn btn-success" data-toggle="modal" data-target="#myModal" (click)="setUpAddFilm()"><i
        class="fas fa-user-plus"></i> Thêm mới</button>
  </div>
  <div class="col-md-10 pr-0">
    <form class="form-inline float-right">
      <div class="form-group">
        <label for="searchFilm">Tìm kiếm</label>
        <input [(ngModel)]="inputSearchFilm" name="searchFilm" type="text" id="searchFilm" class="form-control mx-sm-3" (keyup)="searchFilm()">
      </div>
    </form>
  </div>
</div>
<div class="table-responsive">
  <table class="table table-striped table-bordered" *ngIf="listFilm">
    <thead>
      <tr>
        <th>Tên phim</th>
        <th>Mã phim</th>
        <th>Đánh giá</th>
        <th>Hình ảnh</th>
        <th>Tùy chọn</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let film of listFilm.items">
        <td>{{ film.tenPhim }}</td>
        <td>{{ film.maPhim }}</td>
        <td>{{ film.danhGia }}</td>
        <td><a class="btn btn-info btn-sm" href="{{film.hinhAnh}}" target="_blank"><i class="fas fa-eye"></i> Xem ảnh</a></td>
        <td>
          <div class="d-flex justify-content-center">
            <button type="button" class="btn btn-primary mr-2 btn-sm" data-toggle="modal" data-target="#myModal"
              (click)="editFilm(film.maPhim)"><i class="fas fa-user-edit"></i>
              Sửa</button>
            <button type="button" class="btn btn-danger btn-sm" (click)="setFilmDelete(film.maPhim)"><i class="fas fa-user-times"></i> Xóa</button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Xử lý phân trang -->
<nav aria-label="Page navigation example" *ngIf="listFilm">
    <ul class="pagination justify-content-center mb-0 pb-3">
      <li class="page-item" [ngClass]="{'disabled': listFilm && (listFilm.currentPage == 1)}">
        <a class="page-link" href="javascript:void(0)" (click)="previous()">Trang trước</a>
      </li>
      <!-- Nếu tổng số trang <= 7 thì không cần điều chỉnh chỉ việc show ra tất cả, ở đây dùng hàm counter() để biến tổng số trang thành mảng hỗ trợ dùng ngFor -->
      <ng-container *ngIf="listFilm && listFilm.totalPages < 8">
        <li [ngClass]="{'active': (i + 1) == listFilm.currentPage}" class="page-item"
          *ngFor="let number of counter(listFilm.totalPages); let i = index">
          <a class="page-link" href="javascript:void(0)" (click)="getPage(i + 1)">{{ i + 1 }}</a>
        </li>
      </ng-container>
  
      <!-- Nếu số trang lớn hơn 7 và trang hiện tại nhỏ hơn 5 thì lúc này phân trang có dạng 1,2,3,4,5,...,tổng -->
      <ng-container *ngIf="listFilm && listFilm.totalPages > 7 && listFilm.currentPage < 5">
        <li class="page-item" [ngClass]="{'active': (i + 1) == listFilm.currentPage}"
          *ngFor="let number of counter(5); let i = index">
          <a class="page-link" href="javascript:void(0)" (click)="getPage(i + 1)">{{ i + 1 }}</a>
        </li>
        <li class="page-item">
          <a class="page-link" href="javascript:void(0)">...</a>
        </li>
        <li class="page-item">
          <a class="page-link" href="javascript:void(0)" (click)="getPage(listFilm.totalPages)">{{
            listFilm.totalPages
          }}</a>
        </li>
      </ng-container>
  
      <!-- Nếu số trang lớn hơn 7 và trang hiện tại đang >=5 và < tổng - 3 lúc này phân trang sẽ có dạng 1,...,hiện tại - 1, hiện tại, hiện tại + 1,..., tổng -->
      <ng-container *ngIf="
      listFilm &&
      listFilm.totalPages > 7 &&
      listFilm.currentPage > 4 &&
      listFilm.currentPage < listFilm.totalPages - 3
        ">
        <li class="page-item">
          <a class="page-link" href="javascript:void(0)" (click)="getPage(1)">1</a>
        </li>
        <li class="page-item">
          <a class="page-link" href="javascript:void(0)">...</a>
        </li>
        <li class="page-item">
          <a class="page-link" href="javascript:void(0)" (click)="getPage(listFilm.currentPage - 1)">{{
            listFilm.currentPage - 1
          }}</a>
        </li>
        <li class="page-item" [ngClass]="{'active': listFilm.currentPage == listFilm.currentPage}">
          <a class="page-link" href="javascript:void(0)">{{ listFilm.currentPage }}</a>
        </li>
        <li class="page-item">
          <a class="page-link" href="javascript:void(0)" (click)="getPage(listFilm.currentPage + 1)">{{
            listFilm.currentPage + 1
          }}</a>
        </li>
        <li class="page-item">
          <a class="page-link" href="javascript:void(0)">...</a>
        </li>
        <li class="page-item">
          <a class="page-link" href="javascript:void(0)" (click)="getPage(listFilm.totalPages)">{{
            listFilm.totalPages
          }}</a>
        </li>
      </ng-container>
  
      <!-- Nếu số trang lớn hơn 7 và trang hiện tại > tổng - 4 thì lúc này phân trang sẽ có dạng 1, ..., tổng - 4 -> tổng -->
      <ng-container *ngIf="
      listFilm &&
      listFilm.totalPages > 7 &&
      listFilm.currentPage > listFilm.totalPages - 4
        ">
        <li class="page-item">
          <a class="page-link" href="javascript:void(0)" (click)="getPage(1)">1</a>
        </li>
        <li class="page-item">
          <a class="page-link" href="javascript:void(0)">...</a>
        </li>
        <li class="page-item" [ngClass]="{'active': listFilm.currentPage == listFilm.totalPages - 4}">
          <a class="page-link" href="javascript:void(0)" (click)="getPage(listFilm.totalPages - 4)">{{
            listFilm.totalPages - 4
          }}</a>
        </li>
        <li class="page-item" [ngClass]="{'active': listFilm.currentPage == listFilm.totalPages - 3}">
          <a class="page-link" href="javascript:void(0)" (click)="getPage(listFilm.totalPages - 3)">{{
            listFilm.totalPages - 3
          }}</a>
        </li>
        <li class="page-item" [ngClass]="{'active': listFilm.currentPage == listFilm.totalPages - 2}">
          <a class="page-link" href="javascript:void(0)" (click)="getPage(listFilm.totalPages - 2)">{{
            listFilm.totalPages - 2
          }}</a>
        </li>
        <li class="page-item" [ngClass]="{'active': listFilm.currentPage == listFilm.totalPages - 1}">
          <a class="page-link" href="javascript:void(0)" (click)="getPage(listFilm.totalPages - 1)">{{
            listFilm.totalPages - 1
          }}</a>
        </li>
        <li class="page-item" [ngClass]="{'active': listFilm.totalPages == listFilm.currentPage}">
          <a class="page-link" href="javascript:void(0)" (click)="getPage(listFilm.totalPages)">{{
            listFilm.totalPages
          }}</a>
        </li>
      </ng-container>
      <li class="page-item" [ngClass]="{'disabled': listFilm && (listFilm.currentPage == listFilm.totalPages)}">
        <a class="page-link" href="javascript:void(0)" (click)="next()">Trang sau</a>
      </li>
    </ul>
  </nav>
  <!-- End Xử lý phân trang -->
